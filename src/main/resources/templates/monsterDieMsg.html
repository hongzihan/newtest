<!DOCTYPE html>
<html lang="en" xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout" xmlns:th="http://www.w3.org/1999/xhtml">
<head>
<title>Matrix Admin</title>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.5.0/dist/css/bootstrap.min.css" integrity="sha384-9aIt2nRpC12Uk9gS9baDl411NQApFmC26EwAOH8WgZl5MYYxFfc+NcPb1dKGj7Sk" crossorigin="anonymous">
<link rel="stylesheet" href="../static/css/bootstrap.min.css" />
<link rel="stylesheet" href="../static/css/bootstrap-responsive.min.css" />
<link rel="stylesheet" href="../static/css/colorpicker.css" />
<link rel="stylesheet" href="../static/css/datepicker.css" />
<link rel="stylesheet" href="../static/css/uniform.css" />
<link rel="stylesheet" href="../static/css/select2.css" />
<link rel="stylesheet" href="../static/css/matrix-style.css" />
<link rel="stylesheet" href="../static/css/matrix-media.css" />
<link rel="stylesheet" href="../static/css/bootstrap-wysihtml5.css" />
<link href="../static/font-awesome/css/font-awesome.css" rel="stylesheet" />
</head>
<body>
<div th:replace="common/frame-main::frame-main"/>
<!--close-left-menu-stats-sidebar-->

<div id="content">
  <div class="container-fluid">
    <hr>
    <div class="row-fluid">
      <form action="/st/searchMonsterMsg" method="post">
        <div class="input-group">
            <select class="custom-select" id="inputGroupSelect04" name="zonename" aria-label="Example select with button addon">
              <option selected th:unless="${zonename}">Choose...</option>
              <option selected th:if="${zonename}" th:value="${zonename}" name="zonename"><span th:text="${zonename}"/></option>
              <option th:each="zone : ${zoneList}" th:value="${zone.zonename}" name="zonename"><span th:text="${zone.zonename}"/></option>
            </select>
            <div class="input-group-append">
              <button class="btn btn-outline-secondary" type="submit" id="search_mob">搜索</button>
            </div>
        </div>
      </form>
      <hr/>
      <div class="jumbotron" th:if="${mobList != null}">
        <div class="row" th:each="mob,stats: ${mobList}" th:if="${stats.index % 3 == 0}" style="margin-bottom: 10px">
          <div class="col-sm-4">
              <div class="card" name="mobCard">
                <div class="card-body" th:object="${mob}">
                  <p hidden name="mobStatus">[[*{mobStatus}]]</p>
                  <h2 class="card-title"><span th:text="*{mobname}"/>&nbsp;&nbsp;<span class="badge badge-secondary" th:if="*{mobStatus eq '死亡'}" th:text="*{mobStatus}"/><span class="badge badge-success" th:if="*{mobStatus eq '存活'}" th:text="*{mobStatus}"/><span class="badge badge-info" th:if="*{mobStatus eq '未知'}" th:text="*{mobStatus}"/></h2>
                  <h4 style="color: #c09853" class="card-text"><span th:text="'BOSS归属地图：' + *{mapname}"/></h4>
                  <h4 style="color: #da4f49" class="card-text"><span th:text="'BOSS 击杀者：' + *{killer}"/></h4>
                  <h4 style="color: #d59392" class="card-text"><span th:text="'被击杀的时间：' + '' + *{dietime}"/></h4>
                  <h4 style="color: #46a546" class="card-text" th:if="*{futureBornTime}"><span th:text="'预计复活时间：' + *{futureBornTime}"/></h4>
                  <h4 style="color: #3a87ad" class="card-text" th:if="*{relivetime}"><span th:text="'预计复活间隔：' + *{relivetime / 60} + '分钟'"/></h4>
                  <a th:if="*{relivetime}" href="#" th:onclick="clearRT([[*{zonename}]], [[*{mobname}]], [[*{mapname}]])" class="btn btn-primary">重置重生时间</a>
                </div>
              </div>
          </div>
          <div class="col-sm-4" th:if="${stats.index + 1 < stats.size}">
            <div class="card" name="mobCard">
              <div class="card-body" th:object="${mobList[stats.index + 1]}">
                <p hidden name="mobStatus">[[*{mobStatus}]]</p>
                <h2 class="card-title"><span th:text="*{mobname}"/>&nbsp;&nbsp;<span class="badge badge-secondary" th:if="*{mobStatus eq '死亡'}" th:text="*{mobStatus}"/><span class="badge badge-success" th:if="*{mobStatus eq '存活'}" th:text="*{mobStatus}"/><span class="badge badge-info" th:if="*{mobStatus eq '未知'}" th:text="*{mobStatus}"/></h2>
                <h4 style="color: #c09853" class="card-text"><span th:text="'BOSS归属地图：' + *{mapname}"/></h4>
                <h4 style="color: #da4f49" class="card-text"><span th:text="'BOSS 击杀者：' + *{killer}"/></h4>
                <h4 style="color: #d59392" class="card-text"><span th:text="'被击杀的时间：' + '' + *{dietime}"/></h4>
                <h4 style="color: #46a546" class="card-text" th:if="*{futureBornTime}"><span th:text="'预计复活时间：' + *{futureBornTime}"/></h4>
                <h4 style="color: #3a87ad" class="card-text" th:if="*{relivetime}"><span th:text="'预计复活间隔：' + *{relivetime / 60} + '分钟'"/></h4>
                <a th:if="*{relivetime}" href="#" th:onclick="clearRT([[*{zonename}]], [[*{mobname}]], [[*{mapname}]])" class="btn btn-primary">重置重生时间</a>
              </div>
            </div>
          </div>
          <div class="col-sm-4" th:if="${stats.index + 2 < stats.size}">
            <div class="card" name="mobCard">
              <div class="card-body" th:object="${mobList[stats.index + 2]}">
                <p hidden name="mobStatus">[[*{mobStatus}]]</p>
                <h2 class="card-title"><span th:text="*{mobname}"/>&nbsp;&nbsp;<span class="badge badge-secondary" th:if="*{mobStatus eq '死亡'}" th:text="*{mobStatus}"/><span class="badge badge-success" th:if="*{mobStatus eq '存活'}" th:text="*{mobStatus}"/><span class="badge badge-info" th:if="*{mobStatus eq '未知'}" th:text="*{mobStatus}"/></h2>
                <h4 style="color: #c09853" class="card-text"><span th:text="'BOSS归属地图：' + *{mapname}"/></h4>
                <h4 style="color: #da4f49" class="card-text"><span th:text="'BOSS 击杀者：' + *{killer}"/></h4>
                <h4 style="color: #d59392" class="card-text"><span th:text="'被击杀的时间：' + '' + *{dietime}"/></h4>
                <h4 style="color: #46a546" class="card-text" th:if="*{futureBornTime}"><span th:text="'预计复活时间：' + *{futureBornTime}"/></h4>
                <h4 style="color: #3a87ad" class="card-text" th:if="*{relivetime}"><span th:text="'预计复活间隔：' + *{relivetime / 60} + '分钟'"/></h4>
                <a th:if="*{relivetime}" href="#" th:onclick="clearRT([[*{zonename}]], [[*{mobname}]], [[*{mapname}]])" class="btn btn-primary">重置重生时间</a>
              </div>
            </div>
          </div>
        </div>
      </div>


    </div>

  </div>
</div>
<div th:replace="common/frame-footer::frame-footer"/>
<script src="../static/js/jquery.ui.custom.js"></script>
<script src="../static/js/bootstrap.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/jquery@3.5.1/dist/jquery.slim.min.js" integrity="sha384-DfXdz2htPH0lsSSs5nCTpuj/zy4C+OGpamoFVy38MVBnE+IbbVYUew+OrCXaRkfj" crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js" integrity="sha384-Q6E9RHvbIyZFJoft+2mJbHaEWldlvI9IOYy5n3zV9zzTtmI3UksdQRVvoxMfooAo" crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@4.5.0/dist/js/bootstrap.min.js" integrity="sha384-OgVRvuATP1z7JjHLkuOU7Xw704+h835Lr+6QL9UvYjZE3Ipu6Tp75j7Bh/kR0JKI" crossorigin="anonymous"></script>
<script src="../static/js/jquery.min.js"></script>
<script src="../static/js/matrix.js"></script>
<script>

    window.onload=function(){
      let obj = document.getElementsByName("mobCard")
      let obj2 = document.getElementsByName("mobStatus")
      for (let i=0; i < obj.length; i++) {
        let className = document.createAttribute("style")
        if (obj2[i].innerHTML === "死亡") {
          className.nodeValue = "background-color:rgba(255,0,0,0.08);"
        } else if (obj2[i].innerHTML === "存活") {
          className.nodeValue = "background-color:rgba(0,255,0,0.08);"
        } else {
          className.nodeValue = "background-color:rgba(0,0,255,0.08);"
        }
        obj[i].setAttributeNode(className)
      }
    }

    function clearRT(zonename, mobname, mapname) {
      //表单异步提交
      $.ajax({
        type: 'post',
        data: {zonename:zonename,mobname:mobname,mapname:mapname},
        url: '/st/clearRelive',
        cache:false,
        dataType:'text',
        async:false,
        success: function (msg) {
          if (msg === "success") {
            document.getElementById("search_mob").click()
          } else {
            alert("修改失败！")
          }
        }
      })
    }
</script>
</body>
</html>
